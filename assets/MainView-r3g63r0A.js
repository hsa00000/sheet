import{d as Se,a as Le,r as Re,c as Oe,b as U,e as ge,o as he,w,f as k,u as E,g as ce,h as ne,t as me,_ as Ie,i as Me,j as ze,F as Ne,k as qe,l as Be,m as Ve,v as Fe,n as $e}from"./index-fGCpawEI.js";const Ue=Se("activity",{state:()=>({name:"",period:"",location:""}),actions:{}}),_e=10,Ae=Se("participant",{state:()=>({participantList:[],outsider:[]}),getters:{combinedList(v){return[...v.outsider,...v.participantList]}},actions:{isOutsider(v){return this.outsider.includes(v)},deleteByCombinedIndex(v){if(v<this.outsider.length)this.outsider.splice(v,1);else{const S=v-this.outsider.length;S>=0&&S<this.participantList.length&&this.participantList.splice(S,1)}},moveUpInParticipantList(v){if(v>0&&v<this.participantList.length){const S=this.participantList[v];this.participantList[v]=this.participantList[v-1],this.participantList[v-1]=S}},moveDownInParticipantList(v){if(v>=0&&v<this.participantList.length-1){const S=this.participantList[v];this.participantList[v]=this.participantList[v+1],this.participantList[v+1]=S}}}}),He={class:"d-flex flex-row justify-center ga-1"},Ke=Le({__name:"EditView",props:{headers:{}},setup(v){const S=v,Y=Re(1),b=Ue(),O=Ae(),A=Oe(()=>[...S.headers,{title:"操作",key:"actions",align:"center",width:"100px",sortable:!1}]),F=i=>{const a=O.combinedList.findIndex(x=>x===i);a!==-1&&O.deleteByCombinedIndex(a)},Z=i=>{const x=O.combinedList.findIndex(K=>K===i)-O.outsider.length;x>=0&&O.moveUpInParticipantList(x),console.log("participantStore.combinedList is",O.combinedList)},$=i=>{const x=O.combinedList.findIndex(K=>K===i)-O.outsider.length;x>=0&&O.moveDownInParticipantList(x)};return(i,a)=>{const x=U("v-text-field"),K=U("v-card-text"),J=U("v-btn"),re=U("v-data-table"),le=U("v-card");return he(),ge(le,null,{default:w(()=>[k(le,{class:"print-page"},{default:w(()=>[k(K,null,{default:w(()=>[k(x,{modelValue:E(b).name,"onUpdate:modelValue":a[0]||(a[0]=u=>E(b).name=u),label:"活動名稱",variant:"underlined",dense:""},null,8,["modelValue"]),k(x,{modelValue:E(b).period,"onUpdate:modelValue":a[1]||(a[1]=u=>E(b).period=u),label:"活動日期",variant:"underlined",dense:""},null,8,["modelValue"]),k(x,{modelValue:E(b).location,"onUpdate:modelValue":a[2]||(a[2]=u=>E(b).location=u),label:"活動地點",variant:"underlined",dense:""},null,8,["modelValue"])]),_:1}),k(re,{headers:A.value,items:E(O).combinedList,page:Y.value,"onUpdate:page":a[3]||(a[3]=u=>Y.value=u),class:"print-table row-height-26 text-center text-black","items-per-page":E(_e)},{"item.index":w(({index:u})=>[ne(me((Y.value-1)*E(_e)+u+1),1)]),"item.id":w(({item:u})=>[k(x,{modelValue:u.id,"onUpdate:modelValue":N=>u.id=N,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),"item.department":w(({item:u})=>[k(x,{modelValue:u.department,"onUpdate:modelValue":N=>u.department=N,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),"item.name":w(({item:u})=>[k(x,{modelValue:u.name,"onUpdate:modelValue":N=>u.name=N,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),"item.food":w(({item:u})=>[k(x,{modelValue:u.food,"onUpdate:modelValue":N=>u.food=N,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),"item.actions":w(({item:u})=>[ce("div",He,[k(J,{variant:"outlined",onClick:N=>F(u)},{default:w(()=>a[4]||(a[4]=[ne("刪除")])),_:2},1032,["onClick"]),k(J,{variant:"outlined",onClick:N=>Z(u),disabled:E(O).isOutsider(u)},{default:w(()=>a[5]||(a[5]=[ne(" 上移 ")])),_:2},1032,["onClick","disabled"]),k(J,{variant:"outlined",onClick:N=>$(u),disabled:E(O).isOutsider(u)},{default:w(()=>a[6]||(a[6]=[ne(" 下移 ")])),_:2},1032,["onClick","disabled"])])]),_:2},1032,["headers","items","page","items-per-page"])]),_:1})]),_:1})}}}),We=Ie(Ke,[["__scopeId","data-v-4a5e5a9c"]]),je=Se("emptyPageNumber",{state:()=>({emptyPageNumber:1}),actions:{}}),Qe={class:"text-h3 font-weight-bold"},Je={class:"text-h5"},Ze={class:"text-h5"},Ge={class:"text-h5"},Ye=Le({__name:"PrintView",props:{headers:{}},setup(v){const S=Ue(),Y=Ae(),b=je(),O=Oe(()=>{const A=[...Y.combinedList],F=Math.ceil(A.length/10)*10-A.length+b.emptyPageNumber*10;for(let $=0;$<F;$++)A.push({id:"",department:"",name:"",food:""});console.log("combined result is",A);const Z=[];for(let $=0;$<A.length;$+=_e)Z.push(A.slice($,$+_e));return Z});return(A,F)=>{const Z=U("v-card-title"),$=U("v-card-text"),i=U("v-data-table"),a=U("v-card");return he(),ge(a,{variant:"text"},{default:w(()=>[k(Z,{class:"no-print d-flex justify-center"},{default:w(()=>F[0]||(F[0]=[ne("直接使用 Chrome 列印即可")])),_:1}),(he(!0),Me(Ne,null,ze(O.value,(x,K)=>(he(),ge(a,{key:K,class:"print-page",variant:"text"},{default:w(()=>[k($,{class:"text-body-1 text-center"},{default:w(()=>[ce("p",Qe,me(`${E(S).name}簽到表`),1)]),_:1}),k($,{class:"text-body-1"},{default:w(()=>[ce("p",Je,[F[1]||(F[1]=ce("span",null,"活動名稱：",-1)),ne(me(E(S).name),1)]),ce("p",Ze,[F[2]||(F[2]=ce("span",null,"活動期間：",-1)),ne(me(E(S).period),1)]),ce("p",Ge,[F[3]||(F[3]=ce("span",null,"活動地點：",-1)),ne(me(E(S).location),1)])]),_:1}),k(i,{"border-collapse:":"",collapse:"",headers:A.headers,items:x,class:"print-table row-height-26 text-center text-black","items-per-page":E(_e)},{"item.index":w(({index:J})=>[ne(me(K*E(_e)+J+1),1)]),bottom:w(()=>F[4]||(F[4]=[])),_:2},1032,["headers","items","items-per-page"])]),_:2},1024))),128))]),_:1})}}}),Xe=Ie(Ye,[["__scopeId","data-v-c910f7ab"]]);function et(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var Ee={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var tt=Ee.exports,Pe;function nt(){return Pe||(Pe=1,function(v,S){((Y,b)=>{v.exports=b()})(tt,function Y(){var b=typeof self<"u"?self:typeof window<"u"?window:b!==void 0?b:{},O,A=!b.document&&!!b.postMessage,F=b.IS_PAPA_WORKER||!1,Z={},$=0,i={};function a(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var n=be(t);n.chunkSize=parseInt(n.chunkSize),t.step||t.chunk||(n.chunkSize=null),this._handle=new le(n),(this._handle.streamer=this)._config=n}).call(this,e),this.parseChunk=function(t,n){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let p=this._config.newline;p||(r=this._config.quoteChar||'"',p=this._handle.guessLineEndings(t,r)),t=[...t.split(p).slice(s)].join(p)}this.isFirstChunk&&R(this._config.beforeFirstChunk)&&(r=this._config.beforeFirstChunk(t))!==void 0&&(t=r),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,r=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=r.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),r&&r.data&&(this._rowCount+=r.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),F)b.postMessage({results:r,workerId:i.WORKER_ID,finished:s});else if(R(this._config.chunk)&&!n){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=r=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!s||!R(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||r&&r.meta.paused||this._nextChunk(),r}this._halted=!0},this._sendError=function(t){R(this._config.error)?this._config.error(t):F&&this._config.error&&b.postMessage({workerId:i.WORKER_ID,error:t,finished:!1})}}function x(e){var t;(e=e||{}).chunkSize||(e.chunkSize=i.RemoteChunkSize),a.call(this,e),this._nextChunk=A?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),A||(t.onload=q(this._chunkLoaded,this),t.onerror=q(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!A),this._config.downloadRequestHeaders){var n,s=this._config.downloadRequestHeaders;for(n in s)t.setRequestHeader(n,s[n])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+r));try{t.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}A&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(n){n=t.statusText||n,this._sendError(new Error(n))}}function K(e){(e=e||{}).chunkSize||(e.chunkSize=i.LocalChunkSize),a.call(this,e);var t,n,s=typeof FileReader<"u";this.stream=function(r){this._input=r,n=r.slice||r.webkitSlice||r.mozSlice,s?((t=new FileReader).onload=q(this._chunkLoaded,this),t.onerror=q(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var r=this._input,p=(this._config.chunkSize&&(p=Math.min(this._start+this._config.chunkSize,this._input.size),r=n.call(r,this._start,p)),t.readAsText(r,this._config.encoding));s||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(r){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(r.target.result)},this._chunkError=function(){this._sendError(t.error)}}function J(e){var t;a.call(this,e=e||{}),this.stream=function(n){return t=n,this._nextChunk()},this._nextChunk=function(){var n,s;if(!this._finished)return n=this._config.chunkSize,t=n?(s=t.substring(0,n),t.substring(n)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function re(e){a.call(this,e=e||{});var t=[],n=!0,s=!1;this.pause=function(){a.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){a.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(r){this._input=r,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=q(function(r){try{t.push(typeof r=="string"?r:r.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(p){this._streamError(p)}},this),this._streamError=q(function(r){this._streamCleanUp(),this._sendError(r)},this),this._streamEnd=q(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function le(e){var t,n,s,r,p=Math.pow(2,53),j=-p,X=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ee=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,f=this,D=0,l=0,W=!1,c=!1,m=[],o={data:[],errors:[],meta:{}};function M(_){return e.skipEmptyLines==="greedy"?_.join("").trim()==="":_.length===1&&_[0].length===0}function P(){if(o&&s&&(te("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+i.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(o.data=o.data.filter(function(d){return!M(d)})),H()){let d=function(V,z){R(e.transformHeader)&&(V=e.transformHeader(V,z)),m.push(V)};if(o)if(Array.isArray(o.data[0])){for(var _=0;H()&&_<o.data.length;_++)o.data[_].forEach(d);o.data.splice(0,1)}else o.data.forEach(d)}function y(d,V){for(var z=e.header?{}:[],C=0;C<d.length;C++){var L=C,g=d[C],g=((ie,h)=>(I=>(e.dynamicTypingFunction&&e.dynamicTyping[I]===void 0&&(e.dynamicTyping[I]=e.dynamicTypingFunction(I)),(e.dynamicTyping[I]||e.dynamicTyping)===!0))(ie)?h==="true"||h==="TRUE"||h!=="false"&&h!=="FALSE"&&((I=>{if(X.test(I)&&(I=parseFloat(I),j<I&&I<p))return 1})(h)?parseFloat(h):ee.test(h)?new Date(h):h===""?null:h):h)(L=e.header?C>=m.length?"__parsed_extra":m[C]:L,g=e.transform?e.transform(g,L):g);L==="__parsed_extra"?(z[L]=z[L]||[],z[L].push(g)):z[L]=g}return e.header&&(C>m.length?te("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+C,l+V):C<m.length&&te("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+C,l+V)),z}var T;o&&(e.header||e.dynamicTyping||e.transform)&&(T=1,!o.data.length||Array.isArray(o.data[0])?(o.data=o.data.map(y),T=o.data.length):o.data=y(o.data,0),e.header&&o.meta&&(o.meta.fields=m),l+=T)}function H(){return e.header&&m.length===0}function te(_,y,T,d){_={type:_,code:y,message:T},d!==void 0&&(_.row=d),o.errors.push(_)}R(e.step)&&(r=e.step,e.step=function(_){o=_,H()?P():(P(),o.data.length!==0&&(D+=_.data.length,e.preview&&D>e.preview?n.abort():(o.data=o.data[0],r(o,f))))}),this.parse=function(_,y,T){var d=e.quoteChar||'"',d=(e.newline||(e.newline=this.guessLineEndings(_,d)),s=!1,e.delimiter?R(e.delimiter)&&(e.delimiter=e.delimiter(_),o.meta.delimiter=e.delimiter):((d=((V,z,C,L,g)=>{var ie,h,I,ue;g=g||[",","	","|",";",i.RECORD_SEP,i.UNIT_SEP];for(var pe=0;pe<g.length;pe++){for(var se,ye=g[pe],Q=0,ae=0,B=0,G=(I=void 0,new N({comments:L,delimiter:ye,newline:z,preview:10}).parse(V)),de=0;de<G.data.length;de++)C&&M(G.data[de])?B++:(se=G.data[de].length,ae+=se,I===void 0?I=se:0<se&&(Q+=Math.abs(se-I),I=se));0<G.data.length&&(ae/=G.data.length-B),(h===void 0||Q<=h)&&(ue===void 0||ue<ae)&&1.99<ae&&(h=Q,ie=ye,ue=ae)}return{successful:!!(e.delimiter=ie),bestDelimiter:ie}})(_,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=d.bestDelimiter:(s=!0,e.delimiter=i.DefaultDelimiter),o.meta.delimiter=e.delimiter),be(e));return e.preview&&e.header&&d.preview++,t=_,n=new N(d),o=n.parse(t,y,T),P(),W?{meta:{paused:!0}}:o||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,n.abort(),t=R(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){f.streamer._halted?(W=!1,f.streamer.parseChunk(t,!0)):setTimeout(f.resume,3)},this.aborted=function(){return c},this.abort=function(){c=!0,n.abort(),o.meta.aborted=!0,R(e.complete)&&e.complete(o),t=""},this.guessLineEndings=function(V,d){V=V.substring(0,1048576);var d=new RegExp(u(d)+"([^]*?)"+u(d),"gm"),T=(V=V.replace(d,"")).split("\r"),d=V.split(`
`),V=1<d.length&&d[0].length<T[0].length;if(T.length===1||V)return`
`;for(var z=0,C=0;C<T.length;C++)T[C][0]===`
`&&z++;return z>=T.length/2?`\r
`:"\r"}}function u(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function N(e){var t=(e=e||{}).delimiter,n=e.newline,s=e.comments,r=e.step,p=e.preview,j=e.fastMode,X=null,ee=!1,f=e.quoteChar==null?'"':e.quoteChar,D=f;if(e.escapeChar!==void 0&&(D=e.escapeChar),(typeof t!="string"||-1<i.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<i.BAD_DELIMITERS.indexOf(s))&&(s=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var l=0,W=!1;this.parse=function(c,m,o){if(typeof c!="string")throw new Error("Input must be a string");var M=c.length,P=t.length,H=n.length,te=s.length,_=R(r),y=[],T=[],d=[],V=l=0;if(!c)return Q();if(j||j!==!1&&c.indexOf(f)===-1){for(var z=c.split(n),C=0;C<z.length;C++){if(d=z[C],l+=d.length,C!==z.length-1)l+=n.length;else if(o)return Q();if(!s||d.substring(0,te)!==s){if(_){if(y=[],ue(d.split(t)),ae(),W)return Q()}else ue(d.split(t));if(p&&p<=C)return y=y.slice(0,p),Q(!0)}}return Q()}for(var L=c.indexOf(t,l),g=c.indexOf(n,l),ie=new RegExp(u(D)+u(f),"g"),h=c.indexOf(f,l);;)if(c[l]===f)for(h=l,l++;;){if((h=c.indexOf(f,h+1))===-1)return o||T.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:l}),se();if(h===M-1)return se(c.substring(l,h).replace(ie,f));if(f===D&&c[h+1]===D)h++;else if(f===D||h===0||c[h-1]!==D){L!==-1&&L<h+1&&(L=c.indexOf(t,h+1));var I=pe((g=g!==-1&&g<h+1?c.indexOf(n,h+1):g)===-1?L:Math.min(L,g));if(c.substr(h+1+I,P)===t){d.push(c.substring(l,h).replace(ie,f)),c[l=h+1+I+P]!==f&&(h=c.indexOf(f,l)),L=c.indexOf(t,l),g=c.indexOf(n,l);break}if(I=pe(g),c.substring(h+1+I,h+1+I+H)===n){if(d.push(c.substring(l,h).replace(ie,f)),ye(h+1+I+H),L=c.indexOf(t,l),h=c.indexOf(f,l),_&&(ae(),W))return Q();if(p&&y.length>=p)return Q(!0);break}T.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:l}),h++}}else if(s&&d.length===0&&c.substring(l,l+te)===s){if(g===-1)return Q();l=g+H,g=c.indexOf(n,l),L=c.indexOf(t,l)}else if(L!==-1&&(L<g||g===-1))d.push(c.substring(l,L)),l=L+P,L=c.indexOf(t,l);else{if(g===-1)break;if(d.push(c.substring(l,g)),ye(g+H),_&&(ae(),W))return Q();if(p&&y.length>=p)return Q(!0)}return se();function ue(B){y.push(B),V=l}function pe(B){var G=0;return G=B!==-1&&(B=c.substring(h+1,B))&&B.trim()===""?B.length:G}function se(B){return o||(B===void 0&&(B=c.substring(l)),d.push(B),l=M,ue(d),_&&ae()),Q()}function ye(B){l=B,ue(d),d=[],g=c.indexOf(n,l)}function Q(B){if(e.header&&!m&&y.length&&!ee){var G=y[0],de={},Ce=new Set(G);let De=!1;for(let fe=0;fe<G.length;fe++){let oe=G[fe];if(de[oe=R(e.transformHeader)?e.transformHeader(oe,fe):oe]){let ke,Te=de[oe];for(;ke=oe+"_"+Te,Te++,Ce.has(ke););Ce.add(ke),G[fe]=ke,de[oe]++,De=!0,(X=X===null?{}:X)[ke]=oe}else de[oe]=1,G[fe]=oe;Ce.add(oe)}De&&console.warn("Duplicate headers found and renamed."),ee=!0}return{data:y,errors:T,meta:{delimiter:t,linebreak:n,aborted:W,truncated:!!B,cursor:V+(m||0),renamedHeaders:X}}}function ae(){r(Q()),y=[],T=[]}},this.abort=function(){W=!0},this.getCharIndex=function(){return l}}function ve(e){var t=e.data,n=Z[t.workerId],s=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){s=!0,we(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:xe,resume:xe};if(R(n.userStep)){for(var p=0;p<t.results.data.length&&(n.userStep({data:t.results.data[p],errors:t.results.errors,meta:t.results.meta},r),!s);p++);delete t.results}else R(n.userChunk)&&(n.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!s&&we(t.workerId,t.results)}function we(e,t){var n=Z[e];R(n.userComplete)&&n.userComplete(t),n.terminate(),delete Z[e]}function xe(){throw new Error("Not implemented.")}function be(e){if(typeof e!="object"||e===null)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=be(e[t]);return n}function q(e,t){return function(){e.apply(t,arguments)}}function R(e){return typeof e=="function"}return i.parse=function(e,t){var n=(t=t||{}).dynamicTyping||!1;if(R(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!R(t.transform)&&t.transform,!t.worker||!i.WORKERS_SUPPORTED)return n=null,i.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),n=new(t.download?x:J)(t)):e.readable===!0&&R(e.read)&&R(e.on)?n=new re(t):(b.File&&e instanceof File||e instanceof Object)&&(n=new K(t)),n.stream(e);(n=(()=>{var s;return!!i.WORKERS_SUPPORTED&&(s=(()=>{var r=b.URL||b.webkitURL||null,p=Y.toString();return i.BLOB_URL||(i.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",p,")();"],{type:"text/javascript"})))})(),(s=new b.Worker(s)).onmessage=ve,s.id=$++,Z[s.id]=s)})()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=R(t.step),t.chunk=R(t.chunk),t.complete=R(t.complete),t.error=R(t.error),delete t.worker,n.postMessage({input:e,config:t,workerId:n.id})},i.unparse=function(e,t){var n=!1,s=!0,r=",",p=`\r
`,j='"',X=j+j,ee=!1,f=null,D=!1,l=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||i.BAD_DELIMITERS.filter(function(m){return t.delimiter.indexOf(m)!==-1}).length||(r=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(n=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(ee=t.skipEmptyLines),typeof t.newline=="string"&&(p=t.newline),typeof t.quoteChar=="string"&&(j=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");f=t.columns}t.escapeChar!==void 0&&(X=t.escapeChar+j),t.escapeFormulae instanceof RegExp?D=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(D=/^[=+\-@\t\r].*$/)}})(),new RegExp(u(j),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return W(null,e,ee);if(typeof e[0]=="object")return W(f||Object.keys(e[0]),e,ee)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||f),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),W(e.fields||[],e.data||[],ee);throw new Error("Unable to serialize unrecognized input");function W(m,o,M){var P="",H=(typeof m=="string"&&(m=JSON.parse(m)),typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(m)&&0<m.length),te=!Array.isArray(o[0]);if(H&&s){for(var _=0;_<m.length;_++)0<_&&(P+=r),P+=c(m[_],_);0<o.length&&(P+=p)}for(var y=0;y<o.length;y++){var T=(H?m:o[y]).length,d=!1,V=H?Object.keys(o[y]).length===0:o[y].length===0;if(M&&!H&&(d=M==="greedy"?o[y].join("").trim()==="":o[y].length===1&&o[y][0].length===0),M==="greedy"&&H){for(var z=[],C=0;C<T;C++){var L=te?m[C]:C;z.push(o[y][L])}d=z.join("").trim()===""}if(!d){for(var g=0;g<T;g++){0<g&&!V&&(P+=r);var ie=H&&te?m[g]:g;P+=c(o[y][ie],g)}y<o.length-1&&(!M||0<T&&!V)&&(P+=p)}}return P}function c(m,o){var M,P;return m==null?"":m.constructor===Date?JSON.stringify(m).slice(1,25):(P=!1,D&&typeof m=="string"&&D.test(m)&&(m="'"+m,P=!0),M=m.toString().replace(l,X),(P=P||n===!0||typeof n=="function"&&n(m,o)||Array.isArray(n)&&n[o]||((H,te)=>{for(var _=0;_<te.length;_++)if(-1<H.indexOf(te[_]))return!0;return!1})(M,i.BAD_DELIMITERS)||-1<M.indexOf(r)||M.charAt(0)===" "||M.charAt(M.length-1)===" ")?j+M+j:M)}},i.RECORD_SEP="",i.UNIT_SEP="",i.BYTE_ORDER_MARK="\uFEFF",i.BAD_DELIMITERS=["\r",`
`,'"',i.BYTE_ORDER_MARK],i.WORKERS_SUPPORTED=!A&&!!b.Worker,i.NODE_STREAM_INPUT=1,i.LocalChunkSize=10485760,i.RemoteChunkSize=5242880,i.DefaultDelimiter=",",i.Parser=N,i.ParserHandle=le,i.NetworkStreamer=x,i.FileStreamer=K,i.StringStreamer=J,i.ReadableStreamStreamer=re,b.jQuery&&((O=b.jQuery).fn.parse=function(e){var t=e.config||{},n=[];return this.each(function(p){if(!(O(this).prop("tagName").toUpperCase()==="INPUT"&&O(this).attr("type").toLowerCase()==="file"&&b.FileReader)||!this.files||this.files.length===0)return!0;for(var j=0;j<this.files.length;j++)n.push({file:this.files[j],inputElem:this,instanceConfig:O.extend({},t)})}),s(),this;function s(){if(n.length===0)R(e.complete)&&e.complete();else{var p,j,X,ee,f=n[0];if(R(e.before)){var D=e.before(f.file,f.inputElem);if(typeof D=="object"){if(D.action==="abort")return p="AbortError",j=f.file,X=f.inputElem,ee=D.reason,void(R(e.error)&&e.error({name:p},j,X,ee));if(D.action==="skip")return void r();typeof D.config=="object"&&(f.instanceConfig=O.extend(f.instanceConfig,D.config))}else if(D==="skip")return void r()}var l=f.instanceConfig.complete;f.instanceConfig.complete=function(W){R(l)&&l(W,f.file,f.inputElem),r()},i.parse(f.file,f.instanceConfig)}}function r(){n.splice(0,1),s()}}),F&&(b.onmessage=function(e){e=e.data,i.WORKER_ID===void 0&&e&&(i.WORKER_ID=e.workerId),typeof e.input=="string"?b.postMessage({workerId:i.WORKER_ID,results:i.parse(e.input,e.config),finished:!0}):(b.File&&e.input instanceof File||e.input instanceof Object)&&(e=i.parse(e.input,e.config))&&b.postMessage({workerId:i.WORKER_ID,results:e,finished:!0})}),(x.prototype=Object.create(a.prototype)).constructor=x,(K.prototype=Object.create(a.prototype)).constructor=K,(J.prototype=Object.create(J.prototype)).constructor=J,(re.prototype=Object.create(a.prototype)).constructor=re,i})}(Ee)),Ee.exports}var it=nt();const rt=et(it),st=Se("mode",{state:()=>({mode:"edit",enableFood:!1}),actions:{}}),at=Le({__name:"MainView",setup(v){const S=st(),Y=Ae(),b=je(),O=Re(null),A=Re(""),F=()=>{const i=A.value.trim();if(!i)return;Y.outsider.some(x=>x.name===i)||(Y.outsider.push({id:"",department:"校外人士",name:i,food:"無須用餐"}),A.value="")};qe(O,i=>{if(!i)return;const a=new FileReader;a.onload=()=>{const x=new Uint8Array(a.result),J=new TextDecoder("big5").decode(x),re=rt.parse(J,{header:!0,skipEmptyLines:!0});Y.participantList=re.data.map(le=>{const u=Object.fromEntries(Object.entries(le).map(([N,ve])=>[N.trim(),ve]));return{id:String(u["職工/學號"]??""),department:String(u.單位??""),name:String(u.參加者??""),food:String(u.提供用餐??"")}}),console.log("解析後的 items:",Y.participantList)},a.readAsArrayBuffer(i)});const Z=[{title:"#",value:"index",width:"5px",align:"center"},{title:"學號",value:"id",width:"100px",align:"center"},{title:"單位",value:"department",width:"100px",align:"center"},{title:"姓名",value:"name",width:"100px",align:"center"},{title:"簽到",value:"sign",width:"100px",align:"center"},{title:"用餐",value:"food",width:"100px",align:"center"}],$=Oe(()=>S.enableFood?Z:Z.filter(i=>i.value!=="food"));return Be(()=>{console.log("modeStore.food is",S.enableFood)}),(i,a)=>{const x=U("v-btn"),K=U("v-toolbar"),J=U("v-checkbox-btn"),re=U("v-list-item-action"),le=U("v-list-item"),u=U("v-col"),N=U("v-file-input"),ve=U("v-text-field"),we=U("v-number-input"),xe=U("v-row"),be=U("v-container");return he(),ge(be,{class:"d-flex justify-center align-center"},{default:w(()=>[k(xe,null,{default:w(()=>[k(K,{class:"invisible-when-print px-2"},{default:w(()=>[k(x,{onClick:a[0]||(a[0]=q=>E(S).mode="edit"),variant:E(S).mode=="edit"?"tonal":void 0},{default:w(()=>a[6]||(a[6]=[ne(" 編輯模式 ")])),_:1},8,["variant"]),k(x,{onClick:a[1]||(a[1]=q=>E(S).mode="print"),variant:E(S).mode=="print"?"tonal":void 0},{default:w(()=>a[7]||(a[7]=[ne(" 列印模式 ")])),_:1},8,["variant"])]),_:1}),Ve(k(u,{cols:"3"},{default:w(()=>[k(le,null,{prepend:w(()=>[k(re,{start:""},{default:w(()=>[k(J,{modelValue:E(S).enableFood,"onUpdate:modelValue":a[2]||(a[2]=q=>E(S).enableFood=q),label:"用餐"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[Fe,E(S).mode==="edit"]]),k(u,{cols:E(S).mode==="edit"?6:12,class:$e(E(S).mode==="print"?"d-flex justify-center":"")},{default:w(()=>[E(S).mode==="edit"?(he(),ge(We,{key:0,headers:$.value},null,8,["headers"])):(he(),ge(Xe,{key:1,headers:$.value},null,8,["headers"]))]),_:1},8,["cols","class"]),Ve(k(u,{cols:"3"},{default:w(()=>[k(N,{"prepend-icon":"","append-inner-icon":"mdi-paperclip",modelValue:O.value,"onUpdate:modelValue":a[3]||(a[3]=q=>O.value=q),label:"選擇 CSV 檔",accept:".csv","show-size":""},null,8,["modelValue"]),k(ve,{modelValue:A.value,"onUpdate:modelValue":a[4]||(a[4]=q=>A.value=q),label:"新增校外人士","hide-details":"",class:"mb-5"},{"append-inner":w(()=>[k(x,{variant:"text",onClick:F,disabled:!A.value},{default:w(()=>a[8]||(a[8]=[ne(" 新增 ")])),_:1},8,["disabled"])]),_:1},8,["modelValue"]),k(we,{modelValue:E(b).emptyPageNumber,"onUpdate:modelValue":a[5]||(a[5]=q=>E(b).emptyPageNumber=q),label:"新增空白頁數",min:0,step:1,"control-variant":"default","hide-details":""},null,8,["modelValue"])]),_:1},512),[[Fe,E(S).mode==="edit"]])]),_:1})]),_:1})}}}),lt=Ie(at,[["__scopeId","data-v-0c750197"]]);export{lt as default};
